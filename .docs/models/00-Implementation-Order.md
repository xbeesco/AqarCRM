# Implementation Order - Al-Hiaa Real Estate Management System
**ترتيب تنفيذ النماذج حسب الأولوية والتبعيات**

## المرحلة 1: الأساسيات والمستخدمين (الأسبوع 1)

### 1. User.md - نظام المستخدمين والأدوار
**الأولوية**: ⭐⭐⭐⭐⭐ (الأهم)  
**السبب**: جميع النماذج الأخرى تعتمد على المستخدمين والصلاحيات
**التحسينات المطلوبة**:
- إضافة الهيكل الإداري: Super Admin → Admin → Employees
- تحسين الأدوار لتشمل: super_admin, admin, employee, owner, tenant
- إعداد permissions مفصلة للدور الإداري

### 2. Location.md - المواقع الهرمية  
**الأولوية**: ⭐⭐⭐⭐  
**السبب**: العقارات والوحدات تحتاج مواقع
**التبعيات**: لا توجد
**التقدير**: 2-3 أيام

---

## المرحلة 2: الأصول الأساسية (الأسبوع 2)

### 3. Property.md - إدارة العقارات
**الأولوية**: ⭐⭐⭐⭐  
**السبب**: أساس النظام - جميع العقود والوحدات مرتبطة بالعقارات
**التبعيات**: User, Location
**التقدير**: 3-4 أيام

### 4. Unit.md - إدارة الوحدات
**الأولوية**: ⭐⭐⭐⭐  
**السبب**: مطلوبة لعقود المستأجرين ودفعات التحصيل
**التبعيات**: Property, User
**التقدير**: 3-4 أيام

---

## المرحلة 3: العقود (الأسبوع 3)

### 5. PropertyContract.md - عقود الملاك
**الأولوية**: ⭐⭐⭐⭐  
**السبب**: أساس حساب دفعات التوريد
**التبعيات**: Property, User
**التقدير**: 3-4 أيام

### 6. UnitContract.md - عقود المستأجرين  
**الأولوية**: ⭐⭐⭐⭐  
**السبب**: أساس حساب دفعات التحصيل
**التبعيات**: Unit, Property, User
**التقدير**: 3-4 أيام

---

## المرحلة 4: النظام المالي (الأسبوع 4)

### 7. CollectionPayment.md - دفعات التحصيل
**الأولوية**: ⭐⭐⭐⭐  
**السبب**: الإيرادات الأساسية من المستأجرين
**التبعيات**: UnitContract
**التقدير**: 4-5 أيام

### 8. Expense.md - المصاريف (بدلاً من PropertyRepair)
**الأولوية**: ⭐⭐⭐  
**السبب**: تؤثر على حسابات دفعات التوريد
**التبعيات**: Property, Unit
**التقدير**: 3-4 أيام

### 9. SupplyPayment.md - دفعات التوريد
**الأولوية**: ⭐⭐⭐⭐  
**السبب**: المخرجات المالية للملاك
**التبعيات**: PropertyContract, CollectionPayment, Expense
**التقدير**: 4-5 أيام

---

## خريطة التبعيات

```
User ────────┬─────────────────────────────────┐
│            │                                 │
Location ────┼─────► Property ─────► Unit ─────┼─────► UnitContract
│            │           │            │       │            │
│            │           │            │       │            ▼
│            │           │            │       │      CollectionPayment
│            │           │            │       │
│            │           ▼            ▼       │
│            │      PropertyContract  │       │
│            │           │            │       │
│            │           ▼            ▼       │
│            └─────► Expense ◄────────────────┘
│                       │
│                       │
└─────────────────► SupplyPayment
```

---

## التحسينات المطلوبة لنظام المستخدمين

### الهيكل الإداري المحسن:

#### 1. Super Admin
- **الصلاحيات**: كامل الصلاحيات في النظام
- **العدد**: 1-2 فقط
- **الوصول**: جميع الوحدات والتقارير

#### 2. Admin  
- **الصلاحيات**: إدارة كاملة عدا إعدادات النظام
- **العدد**: 2-5 حسب الحاجة
- **الوصول**: جميع العقارات والعقود والمالية

#### 3. Employee (موظف)
- **الصلاحيات**: محددة حسب القسم
- **الأقسام المحتملة**:
  - موظف عقود (Contracts Employee)
  - موظف مالية (Finance Employee) 
  - موظف صيانة (Maintenance Employee)
- **الوصول**: محدود حسب التخصص

#### 4. Owner (مالك)
- **الصلاحيات**: عرض عقاراته وتقاريره فقط
- **الوصول**: محدود بعقاراته

#### 5. Tenant (مستأجر)
- **الصلاحيات**: عرض عقوده ودفعاته فقط  
- **الوصول**: محدود جداً

---

## التعديلات المطلوبة في User.md

### إضافة Employee Roles:
```php
// في RoleSeeder
'super_admin' => ['*'], // كامل الصلاحيات
'admin' => ['properties.*', 'contracts.*', 'payments.*', 'reports.*'],
'contracts_employee' => ['contracts.*', 'properties.view', 'units.view'],
'finance_employee' => ['payments.*', 'reports.financial'],
'maintenance_employee' => ['expenses.*', 'properties.view', 'units.view'],
'owner' => ['own_properties.view', 'own_reports.view'],
'tenant' => ['own_contracts.view', 'own_payments.view']
```

### إضافة Department Field للموظفين:
```php
// إضافة في users migration
$table->string('department')->nullable(); // contracts, finance, maintenance
$table->json('assigned_properties')->nullable(); // للموظفين المخصصين لعقارات محددة
```

---

## التوصيات للتنفيذ

### 1. ابدأ بـ User.md مع التحسينات
- تطبيق الهيكل الإداري الجديد
- إعداد permissions مفصلة
- اختبار الصلاحيات

### 2. ثم Location.md
- بناء هيكل المواقع الهرمي
- اختبار الاختيار المتسلسل

### 3. بناء النماذج بالترتيب المذكور
- كل نموذج يعتمد على السابق
- اختبار التكامل في كل مرحلة

### 4. في النهاية: Integration Testing
- اختبار التدفقات الكاملة
- اختبار الصلاحيات لكل دور
- اختبار الحسابات المالية

هذا الترتيب يضمن بناء متدرج وسليم للنظام مع تجنب مشاكل التبعيات.