# ๐ ุชูุฑูุฑ ูุฑุงุฌุนุฉ ุงูุตูุงุญูุงุช ูุงูุซุบุฑุงุช ุงูุฃูููุฉ

## ๐ ุชุงุฑูุฎ ุงููุฑุงุฌุนุฉ: 31-08-2025

## ๐ฏ ุงููุฏู
ูุฑุงุฌุนุฉ ูุธุงู ุงูุตูุงุญูุงุช ููุชุฃูุฏ ูู:
1. ุงูููุธููู ูุง ูููููู ุฅุถุงูุฉ/ุชุนุฏูู/ุญุฐู ุงููุณุชุฎุฏููู
2. ููุน ุงููุตูู ุงููุจุงุดุฑ ููุตูุญุงุช ุนุจุฑ URL
3. ุชุทุจูู ุงูุตูุงุญูุงุช ุนูู ูู ุงูู Resources

---

## ๐จ ุงูุซุบุฑุงุช ุงูููุชุดูุฉ

### 1. **UserResource - ููุชูุญ ููุฌููุน**
**ุงูููู:** `app/Filament/Resources/UserResource.php`
- โ **ุงููุดููุฉ:** ูุง ููุฌุฏ ุฃู ูููุฏ ุนูู ูู ููููู ุงููุตูู
- โ **ุงูุฎุทูุฑุฉ:** ุนุงููุฉ ุฌุฏุงู
- โ **ุงูุญู ุงููุทููุจ:** ุฅุถุงูุฉ `canAccess()` ู `canViewAny()` ู `canCreate()` ู `canEdit()` ู `canDelete()`

### 2. **EmployeeResource - ููุชูุญ ููุฌููุน**
**ุงูููู:** `app/Filament/Resources/EmployeeResource.php`
- โ **ุงููุดููุฉ:** ุฃู ููุธู ููููู ุชุนุฏูู ููุธููู ุขุฎุฑูู
- โ **ุงูุฎุทูุฑุฉ:** ุนุงููุฉ
- โ **ุงูุญู ุงููุทููุจ:** ูุตุฑ ุงููุตูู ุนูู super_admin ู admin ููุท

### 3. **OwnerResource - ููุชูุญ ููุฌููุน**
**ุงูููู:** `app/Filament/Resources/OwnerResource.php`  
- โ **ุงููุดููุฉ:** ุงูููุธููู ูููููู ุชุนุฏูู ุจูุงูุงุช ุงูููุงู
- โ **ุงูุฎุทูุฑุฉ:** ุนุงููุฉ
- โ **ุงูุญู ุงููุทููุจ:** ููุน ุงูุชุนุฏูู ูุงูุญุฐู ููููุธููู

### 4. **TenantResource - ููุชูุญ ููุฌููุน**
**ุงูููู:** `app/Filament/Resources/TenantResource.php`
- โ **ุงููุดููุฉ:** ุงูููุธููู ูููููู ุชุนุฏูู ุจูุงูุงุช ุงููุณุชุฃุฌุฑูู
- โ **ุงูุฎุทูุฑุฉ:** ูุชูุณุทุฉ
- โ **ุงูุญู ุงููุทููุจ:** ุงูุณูุงุญ ุจุงูุนุฑุถ ููุท ููููุธููู

### 5. **ุงููุตูู ุงููุจุงุดุฑ ุนุจุฑ URL**
- โ **ุงููุดููุฉ:** ูููู ุงููุตูู ูุตูุญุงุช ุงูุชุนุฏูู ูุจุงุดุฑุฉ ุนุจุฑ `/admin/users/1/edit`
- โ **ุงูุฎุทูุฑุฉ:** ุนุงููุฉ ุฌุฏุงู
- โ **ุงูุญู ุงููุทููุจ:** ูุญุต ุงูุตูุงุญูุงุช ูู `EditPage` ู `CreatePage`

---

## ๐๏ธ ุงูุญููู ุงููุทุจูุฉ

### โ ุงูุญู ุงููุทุจู: ุงุณุชุฎุฏุงู Filament Resource Methods

#### ุงูููุฏ ุงููุทุจู ูู UserResource:
```php
// app/Filament/Resources/UserResource.php

// ุตูุงุญูุงุช ุงููุตูู ููู Resource
public static function canViewAny(): bool
{
    $userType = auth()->user()?->type;
    return in_array($userType, ['super_admin', 'admin']);
}

public static function canCreate(): bool
{
    return auth()->user()?->type === 'super_admin';
}

public static function canEdit(\Illuminate\Database\Eloquent\Model $record): bool
{
    return auth()->user()?->type === 'super_admin';
}

public static function canDelete(\Illuminate\Database\Eloquent\Model $record): bool
{
    return auth()->user()?->type === 'super_admin';
}

public static function canDeleteAny(): bool
{
    return auth()->user()?->type === 'super_admin';
}
```

#### ๐ ููุงุฑูุฉ ุงูุทุฑู ุงููุฎุชููุฉ:

| ุงูุทุฑููุฉ | ุงููููุฒุงุช | ุงูุนููุจ | ุงูุชูููู |
|---------|----------|--------|---------|
| **auth()->user()->type** | โข ุจุณูุท ููุฎุชุตุฑ<br>โข ูุฃููู ููุทูุฑู Laravel | โข โ **ุฎุทุฑ!** Error ุฅุฐุง ูู ููู ูุณุฌู ุฏุฎูู<br>โข โ ูุฏ ูุง ูุนูู ูุน guards ูุฎุตุตุฉ | โญโญ |
| **Filament::auth()->user()** | โข โ ูุณุชุฎุฏู guard ุงูุฎุงุต ุจู Filament<br>โข โ ุขูู ูุน ุงูุชุญูู ูู null | โข ุทููู ูุณุจูุงู<br>โข ูุญุชุงุฌ import ุฅุถุงูู | โญโญโญ |
| **optional(auth()->user())** | โข โ ุขูู ูู null errors<br>โข โ Laravel idiomatic | โข ูุฏ ูุง ูุนูู ูุน guards ูุฎุตุตุฉ<br>โข ุฃุทูู ููููุงู | โญโญโญโญ |
| **auth()->user()?->type** โ | โข โ **ุงูุฃูุตุฑ ูุงูุฃูุธู**<br>โข โ ุขูู ูู null<br>โข โ PHP 8 modern syntax<br>โข โ ุณูู ุงููุฑุงุกุฉ | โข ูุญุชุงุฌ PHP 8.0+ | โญโญโญโญโญ |

### ๐ฏ ููุงุฐุง ุงุฎุชุฑูุง `auth()->user()?->type`ุ

1. **ุงูุฃูุงู**: ูุณุชุฎุฏู null-safe operator (`?->`) ููุญูุงูุฉ ูู ุฃุฎุทุงุก null
2. **ุงูุจุณุงุทุฉ**: ุณุทุฑ ูุงุญุฏ ููุท ุจุฏูู ุชุนููุฏุงุช
3. **ุงูุญุฏุงุซุฉ**: ูุณุชุฎุฏู PHP 8 features
4. **ุงูุชูุงูู**: ูุนูู ูุน Filament ูุฃูู ูุณุชุฎุฏู Laravel auth
5. **ุงููุฑุงุกุฉ**: ูุงุถุญ ููุจุงุดุฑ ูููุทูุฑูู

### โ๏ธ ููุงุญุธุงุช ูููุฉ:

1. **PHP Version**: ูุชุทูุจ PHP 8.0 ุฃู ุฃุนูู
2. **User Model**: ูุฌุจ ุฃู ูุญุชูู User model ุนูู ุญูู `type`
3. **Authentication**: ูุฌุจ ุฃู ูููู ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู
4. **Testing**: ูุฌุจ ุงุฎุชุจุงุฑ ูู ุงูุตูุงุญูุงุช

### ุงูุญู 3: ุญูุงูุฉ ุตูุญุงุช Edit/Create
```php
// ูู EditUser.php
public function mount($record): void
{
    abort_unless(static::getResource()::canEdit($this->getRecord()), 403);
    parent::mount($record);
}

// ูู CreateUser.php
public function mount(): void
{
    abort_unless(static::getResource()::canCreate(), 403);
    parent::mount();
}
```

---

## ๐ ูุตูููุฉ ุงูุตูุงุญูุงุช ุงููุทููุจุฉ

| Resource | super_admin | admin | manager | employee | owner | tenant |
|----------|------------|-------|---------|----------|-------|--------|
| **Users** |
| - View | โ | โ | โ | โ | โ | โ |
| - Create | โ | โ | โ | โ | โ | โ |
| - Edit | โ | โ | โ | โ | โ | โ |
| - Delete | โ | โ | โ | โ | โ | โ |
| **Employees** |
| - View | โ | โ | โ | โ | โ | โ |
| - Create | โ | โ | โ | โ | โ | โ |
| - Edit | โ | โ | โ | โ | โ | โ |
| - Delete | โ | โ | โ | โ | โ | โ |
| **Owners** |
| - View | โ | โ | โ | โ | โ | โ |
| - Create | โ | โ | โ | โ | โ | โ |
| - Edit | โ | โ | โ | โ | โ | โ |
| - Delete | โ | โ | โ | โ | โ | โ |
| **Tenants** |
| - View | โ | โ | โ | โ | โ | โ |
| - Create | โ | โ | โ | โ | โ | โ |
| - Edit | โ | โ | โ | โ | โ | โ |
| - Delete | โ | โ | โ | โ | โ | โ |

---

## โ ูุงุฆูุฉ ุงูููุงู

- [x] ~~ุฅูุดุงุก UserPolicy~~ (ุงุณุชุฎุฏููุง Resource Methods ุจุฏูุงู ูููุง)
- [ ] ~~ุฅูุดุงุก EmployeePolicy~~ (ุณูุณุชุฎุฏู Resource Methods)
- [x] ุชุญุฏูุซ UserResource ุจุงูุตูุงุญูุงุช โ ุชู
- [ ] ุชุญุฏูุซ EmployeeResource ุจุงูุตูุงุญูุงุช
- [ ] ุชุญุฏูุซ OwnerResource ุจุงูุตูุงุญูุงุช
- [ ] ุชุญุฏูุซ TenantResource ุจุงูุตูุงุญูุงุช
- [ ] ุญูุงูุฉ ุตูุญุงุช Edit ูู ูู Resource
- [ ] ุญูุงูุฉ ุตูุญุงุช Create ูู ูู Resource
- [ ] ุฅุฎูุงุก ุฃุฒุฑุงุฑ Actions ุญุณุจ ุงูุตูุงุญูุงุช
- [ ] ุงุฎุชุจุงุฑ ูู ุงูุตูุงุญูุงุช

### ๐ ุงูุชูุฏู: 10% ููุชูู

---

## ๐ ุงุฎุชุจุงุฑุงุช ูุทููุจุฉ

1. **ุงุฎุชุจุงุฑ ุงูููุธู:**
   - [ ] ูุง ููููู ุฑุคูุฉ ูุงุฆูุฉ Users
   - [ ] ูุง ููููู ุฅุถุงูุฉ ููุธู ุฌุฏูุฏ
   - [ ] ูุง ููููู ุชุนุฏูู ุฃู ูุณุชุฎุฏู
   - [ ] ูุง ููููู ุงููุตูู ูู `/admin/users/1/edit`

2. **ุงุฎุชุจุงุฑ ุงููุฏูุฑ:**
   - [ ] ููููู ุฑุคูุฉ ุงูููุธููู ููุท
   - [ ] ูุง ููููู ุชุนุฏูู Users
   - [ ] ููููู ุฅุถุงูุฉ owners/tenants
   - [ ] ูุง ููููู ุญุฐู ุฃู ุดูุก

3. **ุงุฎุชุจุงุฑ Admin:**
   - [ ] ููููู ุฅุฏุงุฑุฉ ุงูููุธููู
   - [ ] ูุง ููููู ุชุนุฏูู super_admin
   - [ ] ููููู ุฅุฏุงุฑุฉ owners/tenants

4. **ุงุฎุชุจุงุฑ Super Admin:**
   - [ ] ูุตูู ูุงูู ููู ุดูุก

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ูุฌุจ** ุชุทุจูู ุงูุตูุงุญูุงุช ูู ุงูู Backend ุฃูุถุงู (Controllers/API)
2. **ูุฌุจ** ุฅุถุงูุฉ Middleware ููุชุญูู ูู ุงูุตูุงุญูุงุช
3. **ูุฌุจ** ุชุณุฌูู ูู ูุญุงููุงุช ุงููุตูู ุบูุฑ ุงููุตุฑุญ ุจูุง
4. **ูุฌุจ** ุนูู audit log ููู ุงูุนูููุงุช ุงูุญุณุงุณุฉ

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. ุชุทุจูู ุงูุญููู ูู ุงูููุฏ
2. ุงุฎุชุจุงุฑ ูู ุตูุงุญูุฉ
3. ูุฑุงุฌุนุฉ ุงูู Backend
4. ุฅุถุงูุฉ logging
5. ุฅุถุงูุฉ 2FA ููุญุณุงุจุงุช ุงูุญุณุงุณุฉ